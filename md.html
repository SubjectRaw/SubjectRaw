
<!doctype html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <title>MD.viewer.</title>
  <link href="libs/jquery.splitter.css" rel="stylesheet"/>
  <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="libs/jquery.splitter-0.14.0.js"></script>

<script src="libs/marked.js"></script>

<script src="http://rawgithub.com/ajaxorg/ace-builds/master/src/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="http://rawgithub.com/ajaxorg/ace-builds/master/src/ext-language_tools.js" type="text/javascript" charset="utf-8"></script>



  
  <style>
  
    html, body {
      height: 100%;
      width: 100%;
      margin: 0;
      font-family: Helvetica;
      -webkit-user-select: none;
      -moz-user-select: none;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      background-color: #fff; 

    }



    #editor1 { 
        position: relative;
        width: 100%;
        height: 100%;
        top:0px;
        overflow: scroll;

    }



        
    
  </style>

<script type="text/javascript">

</script>
  
</head>
<body>


      
      <div id="cont1" >
        <div >
          <div id="editor1"  onchange="refresh()"  onkeyup="refresh()">

          </div>
        </div>




        <div id="content1">
         

        </div>
        
        
        
      </div>
    
  
 <script>

function goto(anchor){
  element_to_scroll_to = $('a[name='+anchor+']')
  element_to_scroll_to[0].scrollIntoView();
}

function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

function fillEditor(url){
  $.ajax(
    url)
  .done(
    function(data) {
      //console.info(data)
        //parent.$("#editor").html(data)
        editor.setValue(data)
        refresh();

        
    })
}


function loadDoc(){
  var url = getParameterByName("url");
  if (url) fillEditor(url);

}

 function refresh() {
  
  var val = editor.getValue();
  var out = marked(val , {
    xhtml: true, 
    //gfm: true,

  });

  function toTitleCase(str){
    return str.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
  }

  function seeSubject(){
  	parent.$("#docu").html("<iframe id=\"frame\" src=\"subject.html\" frameborder=\"0\" scroll=\"no\"></iframe>");
  	$("#docu").css({width:"100%", height: "100%"})
  }

  function subject() {
    var add = '<iframe id="frame" src="subject.html" frameborder="0" scroll="no"></iframe>';
    $("#docu").css("visibility","hidden")
    $("#left").append(add)
  }

  

  String.repeat = function(string, num){ return new Array(parseInt(num) + 1).join(string); };

  var renderer = new marked.Renderer();
  var content =""

renderer.heading = function (text, level) {
  var escapedText = text.toLowerCase().replace(/[^\w]+/g, '-');
  content = content+' <span id="'+escapedText+'" onclick="goto(\''+escapedText+'\')">'+String.repeat("&nbsp;",level)+text+'</span><br/>';



  return '<h' + level + '><a name="' +
                escapedText +
                 '" class="anchor" href="#' +
                 escapedText +
                 '"><span class="header-link"></span></a>' +
                  text + '</h' + level + '>';
}





var out = marked(val , {
    xhtml: true, 
    renderer: renderer
    //gfm: true,

  });

  document.getElementById("content1").innerHTML =out;


}

 var editor = ace.edit("editor1");

    editor.setTheme("ace/theme/xcode");
    editor.getSession().setMode("ace/mode/markdown");
    editor.getSession().setUseWrapMode(true);


    var choices = [], try_url="";

    




    

jQuery(function($) {
  
   $('#cont1').width("100%").height("100%").split({orientation:'vertical', limit:1, position: "0%"});


loadDoc()



});

    </script>
  
</body>
</html>